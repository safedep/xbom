# Code Analysis Report

**Generated At:** {{.GeneratedAt}}

---

{{if .Config.ShowExecutiveSummary}}

## Executive Summary

This report provides a comprehensive analysis of code patterns and signatures detected during the scan. The analysis identifies potential security concerns, code capabilities, and interesting patterns across the codebase. The report was generated using [SafeDep xbom](https://github.com/safedep/xbom) tool.

{{if .HasFindings}}
The scan has identified **{{.Statistics.TotalFindings}}** findings across **{{.Statistics.FilesAffected}}** files, matching **{{.Statistics.UniqueSignatures}}** unique signature patterns. The analyzed code spans **{{.Statistics.LanguagesDetected}}** programming languages.
{{else}}
No signature matches were found during the analysis. The scanned codebase does not contain any patterns matching the configured signatures.
{{end}}

---

{{end}}

{{if and .Config.ShowStatistics .HasFindings}}

## Statistics

The following table summarizes the key metrics from the code analysis:

| Metric                         | Value                             |
| ------------------------------ | --------------------------------- |
| Total Findings                 | {{.Statistics.TotalFindings}}     |
| Unique Signatures Matched      | {{.Statistics.UniqueSignatures}}  |
| Files Affected                 | {{.Statistics.FilesAffected}}     |
| Programming Languages Detected | {{.Statistics.LanguagesDetected}} |

---

{{end}}

{{if and .Config.ShowTopSignatures .HasFindings}}

## Top Matched Signatures

The following signatures were most frequently matched during the analysis:

| Rank | Signature ID | Match Count |
| ---- | ------------ | ----------- |

{{range .TopSignatures -}}
| {{.Rank}} | {{.ID}} | {{.Count}} |
{{end}}

---

{{end}}

{{if and .Config.ShowLanguageBreakdown .HasFindings}}

## Language Breakdown

The following table shows the distribution of findings across different programming languages:

| Language | Findings |
| -------- | -------- |

{{range .LanguageBreakdown -}}
| {{.Language}} | {{.Count}} |
{{end}}

---

{{end}}

{{if and .Config.ShowDetailedFindings .HasFindings}}

## Detailed Findings

This section provides comprehensive details for each matched signature, including file locations, code snippets, and match conditions.

{{range $sigIdx, $sig := .DetailedFindings}}

### {{inc $sigIdx}}. Signature: {{$sig.ID}}

**Description:** {{$sig.Description}}

{{if $sig.Tags -}}
**Tags:** {{join $sig.Tags ", "}}
{{end}}

**Total Matches:** {{$sig.TotalMatches}}

---

#### File Occurrences

{{range $fileIdx, $fileOcc := $sig.FileOccurrences}}

##### {{inc $fileIdx}}. File: `{{$fileOcc.FilePath}}`

**Language:** {{$fileOcc.Language}}

{{range $matchIdx, $match := $fileOcc.Matches}}

###### Match {{inc $matchIdx}}

**Condition:** {{$match.Condition}}

{{if $match.Snippet}}
{{if $match.Snippet.SourceUnavailable}}
**Code Snippet:** _(Source file unavailable)_
{{else}}
**Code Snippet:**

```{{lower $fileOcc.Language}}
{{range $match.Snippet.Lines -}}
{{formatLocation .}}
{{end -}}
```

{{if $match.Snippet.WasTruncated}}
_(Snippet truncated due to size limits)_
{{end}}
{{end}}
{{end}}

{{end}}
{{end}}

---

{{end}}
{{end}}

{{if not .HasFindings}}

## No Findings

The code analysis completed successfully, but no signature matches were detected. This indicates that none of the configured signature patterns were found in the analyzed codebase.

This could mean:

- The code does not contain the patterns being searched for
- The signatures may need adjustment to match the specific coding patterns in your codebase
- The analyzed files may not include the languages or frameworks covered by the signatures

---

{{end}}

## Report Information

**Report Format:** Markdown
**Reporter:** xbom markdown reporter
**Generated:** {{.GeneratedAt}}
**Generated By:** [SafeDep xbom](https://github.com/safedep/xbom)

---

_End of Report_
